# Обобщённые тест-кейсы (обезличено)

В этом документе представлены обезличенные примеры тест-кейсов, оформленные в системе управления тестами. Все данные синтетические, без указания настоящих URL, имен таблиц, пользователей или структур.

---

## 1. UI. Открытие модальных окон

### ТК: Открытие модального окна "Детальная информация"
**Тип:** Smoke-тест  
**Описание:** Smoke-тест, направленный на проверку работы кнопки "Подробнее" и открытия модального окна
"Детальная информация"
**Шаги:**
1. В карточке отчета нажать на кнопку "Подробнее"

**Ожидаемый результат:** открывается модальное окно "Детальная информация по отчету"

2. Повторить шаг 1 для всех отчетов  
**Ожидаемый результат:** Модальное окно открыто, данные корректны

---

### ТК: Проверка открытия модального окна "Перезапуск по периоду"
**Тип:** Smoke-тест  
**Описание:** Проверка открытия модального окна из бокового меню  
**Шаги:**
1. Навести курсор на кнопку "Меню"

**Ожидаемый результат:** открывается сайдбар со списком "Обновить", "Перевыпуск", "Выгрузить логи", 
    "Внести данные в таблицу1", "Внести данные в таблицу2"

2. ЛКМ нажать на "Перевыпуск"

**Ожидаемый результат:** открывается модальное окно "Перевыпуск"

---

## 2. Интеграционные тесты (UI + БД)

### ТК: Проверка записи в таблицу данных после обновления через UI
**Тип:** Интеграционное  
**Описание:** Проверяется, что после запуска обновления данных через UI данные записываются в БД
**Предварительное условие:** Страница открыта и загружена, пользователь авторизован. Открыто модальное окно
"Детальная информация по T1". Таблицы источники заполнены, процедура T1_UPDATE_DATA скомпилирована без ошибок.

**Шаги:**
1. Удалить записи из таблицы t1 за выбранную дату, выполнив скрипт

```sql 
DELETE FROM T1 
WHERE TRUNC(tradedate) = TO_DATE('03.03.2025','dd.mm.yyyy'); 
COMMIT;
```

**Ожидаемый результат:** скрипт отработал без ошибок.

2. Запустить обновление и перевыпуск через UI
**Ожидаемый результат:** обновление данных завершено, появилось сообщение о завершении.
3. В БД выполнить скрипт:

```sql 
SELECT COUNT(*) AS cnt FROM T1
WHERE TRUNC(tradedate) = TO_DATE('03.03.2025','dd.mm.yyyy')
```
Сверить количество записей в UI (отображается в статусе "Записи") с количеством в поле cnt

**Ожидаемый результат:** запрос вернул результат, в поле cnt значение больше 0. Количество записей в БД и UI совпадает.

---

### ТК: Проверка логирования операций в журнал
**Тип:** Интеграционное  
**Описание:** Проверяется, что после запуска обновления и перевыпуска в БД записываются данные в журналы логирования
**Предварительное условие:** страница открыта и загружена, пользователь авторизован. Открыто модальное окно "Детальная информация"
Таблицы источники заполнены, процедура PROCEDURE скомпилирована без ошибок.
**Шаги:**
1. Запустить процедуры обновления и перевыпуска через UI

**Ожидаемый результат:** процедуры завершены без ошибок, появляются сообщения об успешном завершении.

2. В БД выполнить скрипт

```sql 
SELECT * FROM log1
WHERE TRUNC(updatedate) = TRUNC(SYSDATE) AND message LIKE '%T1%'
ORDER BY updatedate DESC
```

Убедиться, что в журнале присутствуют записи о запуске процедуры обновления данных через UI

**Ожидаемый результат:** в журнале присутствуют записи, в поле updatedate = дата, за которую запускали обновление
данных, в поле PROC = текст, содержащий T1

3. В БД выполнить скрипт

```sql
SELECT * FROM log2
WHERE object = 'T1' AND TRUNC(updatedate) = TRUNC(SYSDATE)
ORDER BY updatedate DESC
```

Убедиться, что в журнале присутствуют записи о запуске процедур обновления данных и перевыпуска через UI,
сверить значения в журнале со значениями, отображаемыми в модальном окне "Детальная информация" в UI (далее пары значение БД - значение UI)
user - автор
reason - причина

**Ожидаемый результат:** записи в журнале присутствуют, значения совпадают


---

## 3. Функциональное тестирование


### ТК: Проверка корректного отображения сделок
**Тип:** Функциональный  
**Описание:** Сделки, заключенные в ДСВД(дополнительная сессия выходного дня) попадают в витрину данных и отображаются в представлении за 10.02.2025 после 
запуска процедуры обновления данных

**Предварительное условие:** источники заполнены. Процедура p1 скомпилирована без ошибок.

**Шаги:**
1. Зафиксировать значения поля tradenumberid сделок, которые были совершены в ДСВД, выполнив запрос в БД:

```sql
SELECT tradenumberid, traddate, sessiondata FROM source_table
WHERE TRUNC(sessiondate) = TO_DATE('10.02.2025','dd.mm.yyyy')
GROUP BY tradenumberid, traddate, sessiondata
ORDER BY tradenumberid
```
Ожидаемый результат: запрос вернул результаты, записи отображаются

2. Запустить процедуру обновления данных за дату 10.02.2025, выполнив в БД скрипт:

```sql
BEGIN
    P1(TO_DATE('10.02.2025','dd.mm.yyyy'));
END;
```

Ожидаемый результат: процедура отработала без ошибок.

3. Проверить, что сделки совершенные в ДСВД из source_table попали в витрину, выполнив скрипт:

```sql
SELECT tgt.tradenumberid,
       CASE
        WHEN tgt.tradenumberid IN (SELECT src.tradenumberid FROM source_table src
                                    WHERE TRUNC(traddate) BETWEEN TO_DATE('08.02.2025','dd.mm.yyyy') AND TO_DATE('10.02.2025','dd.mm.yyyy')
                                    AND (TRUNC(traddate) != TRUNC(sessiondata) OR TRUNC(traddate) = TO_DATE('10.02.2025','dd.mm.yyyy')))
                                    THEN 'Сделка, совершенная в ДСВД попала в витрину'
                                    ELSE 'Сделка, совершенная в ДСВД не попала в витрину'
        END AS check_DSVD
FROM t1 tgt
WHERE TRUNC(rpdat) = TO_DATE('10.02.2025','dd.mm.yyyy')
```
**Ожидаемый результат:** Запрос вернул результат. Все сделки, совершенные в ДСВД(08.02, 09.02, 10.02) попали в витрину

---

Все представленные кейсы написаны вручную и проходят валидацию на синтетических данных. Имена таблиц, полей, URL и прочее — вымышленные либо обезличены.
