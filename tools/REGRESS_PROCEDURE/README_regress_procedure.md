# Процедура QA_REGRES: регрессионная проверка изменений данных в таблицах

## Описание:

    Процедура QA_REGRES используется на стенде QA для регрессионного тестирования витрин.
    Основной смысл — запустить указанную процедуру обновления данных, сохранить срез данных до её выполнения,
    затем сравнить результат после выполнения процедуры с сохранённым срезом и зафиксировать расхождения в лог.

    Работает по принципу:
    - сохраняем срез из таблицы <v_table_name> по указанной дате в BACKUP_<v_table_name>
    - запускаем p_procedure
    - сравниваем: SELECT ... MINUS SELECT ... из бэкапа
    - если расхождения найдены — пишется запись в qa_regres_log

## Входные параметры:

    p_procedure     — имя процедуры, которую нужно запустить (например, 'P1')
    v_table_name    — имя таблицы, по которой будет сделан срез до изменений (например, 'T1')
    v_backup_name   — имя таблицы с бэкапом для сравнения (например, 'BACKUP_T1')
    p_date          — дата, по которой будут фильтроваться данные (например, TO_DATE('10.06.2025', 'dd.mm.yyyy'))
    p_column_list   — список колонок, участвующих в сравнении (COL_LIST('col1', 'col2', 'col3'))

## Поведение:

    - Если таблицы BACKUP_<v_table_name> нет — создаёт и сохраняет срез
    - Если таблица есть — очищает и вставляет новый срез
    - Далее запускается p_procedure по дате
    - После выполнения — сравнение через MINUS: что изменилось
    - Результат (наличие/отсутствие расхождений) фиксируется в qa_regres_log

## Пример:

```sql
DECLARE
    col_list column_list := column_list('id', 'amount', 'status');
BEGIN
    qa_regres(
        p_procedure   => 'P1',
        v_table_name  => 'T1',
        v_backup_name => 'BACKUP_T1',
        p_date        => TO_DATE('10.06.2025', 'dd.mm.yyyy'),
        p_column_list => col_list
    );
END;
```